<!DOCTYPE html>
<html>
<head>
    <title>Test Edge Function</title>
</head>
<body>
    <h1>Test Edge Function Endpoints</h1>
    <button onclick="testRoot()">Test Root /</button>
    <button onclick="testHealth()">Test /health</button>
    <button onclick="testTip()">Test POST /:artistId</button>
    <pre id="output"></pre>

    <script>
        const BASE_URL = 'https://phybdsfwycygroebrsdx.supabase.co/functions/v1/tip-artist';
        const ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBoeWJkc2Z3eWN5Z3JvZWJyc2R4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NzM5NjksImV4cCI6MjA3MjI0OTk2OX0.wQY7tt0gN1fvRjgHiPJK7I1M9ZhmgTbLNffGvcbWJko';

        function log(msg) {
            document.getElementById('output').textContent += msg + '\n';
        }

        async function testRoot() {
            log('\n=== Testing GET / ===');
            try {
                const response = await fetch(BASE_URL, {
                    headers: {
                        'apikey': ANON_KEY,
                        'Authorization': `Bearer ${ANON_KEY}`
                    }
                });
                log(`Status: ${response.status}`);
                const data = await response.text();
                log(`Response: ${data}`);
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }

        async function testHealth() {
            log('\n=== Testing GET /health ===');
            try {
                const response = await fetch(`${BASE_URL}/health`, {
                    headers: {
                        'apikey': ANON_KEY,
                        'Authorization': `Bearer ${ANON_KEY}`
                    }
                });
                log(`Status: ${response.status}`);
                const data = await response.text();
                log(`Response: ${data}`);
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }

        async function testTip() {
            log('\n=== Testing POST /test-artist ===');
            try {
                const response = await fetch(`${BASE_URL}/test-artist`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'apikey': ANON_KEY,
                        'Authorization': `Bearer ${ANON_KEY}`
                    },
                    body: JSON.stringify({
                        amount: '0.05',
                        artistWallet: '0xdf833f835c29040597e3bb84e2edf554df25d3eb'
                    })
                });
                log(`Status: ${response.status}`);
                const data = await response.text();
                log(`Response: ${data}`);
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>
